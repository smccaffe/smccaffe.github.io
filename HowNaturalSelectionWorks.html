<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; How Natural Selection Works – Evolution 303</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./EvolTreesAndPhylogenetics.html" rel="next">
<link href="./EvidenceForEvolution.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IntroBasicConcepts.html">Introduction: Basic Concepts</a></li><li class="breadcrumb-item"><a href="./HowNaturalSelectionWorks.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">How Natural Selection Works</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Evolution 303</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Evolution 303</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface - Evolution 303</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./IntroBasicConcepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Basic Concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./WhatEvolutionIs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">What evolution is</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HistoricaPerspective.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A brief history of evolutionary thought</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvidenceForEvolution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Evidence for Evolution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HowNaturalSelectionWorks.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">How Natural Selection Works</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./EvolTreesAndPhylogenetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Evolutionary Trees and Phylogenetics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./UnderstandingEvolTrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Understanding Evolutionary Trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EstimatingEvoTrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estimating evolutionary trees</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./EvolGenetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Evolutionary Genetics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GenesMutationGeneticVariation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Genes, mutation, and genetic variation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IntroEvolGenetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction: Evolutionary genetics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MechEvolDrift.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Genetic Drift</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MechEvolSelection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mechanisms that drive evolution: natural selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MechEvolMutation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mutation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MechEvolMigration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Migration and other factors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvolPhenotype.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Evolution of Quantitative Traits</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">In Light Of Evolution</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./KinAndSexualSelection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Social Behavior and Sexual Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Adaptations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Adaptation and Phenotypic Plasticity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SpeciesSpeciation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Species and Speciation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvolutionGenomicLevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Evolution at the genomic level</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvoDevo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">EvoDevo</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Evolution At The Macro Level</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvoBiogeogrphy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Evolutionary Biogeography</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DivLife.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Diversification and patterns of life through time</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">What About Us</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./HumanEvol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Human Evolution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvolMed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Evolutionary Medicine</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvolMedPartI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Evolutionary Medicine I: Aging and Diseases of Civilization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EvolMedPartII.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Evolutionary Medicine II: Evolving Pathogens</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#a-mechanism-for-change" id="toc-a-mechanism-for-change" class="nav-link active" data-scroll-target="#a-mechanism-for-change"><span class="header-section-number">4.1</span> A Mechanism for Change</a></li>
  <li><a href="#darwins-and-wallaces-logic" id="toc-darwins-and-wallaces-logic" class="nav-link" data-scroll-target="#darwins-and-wallaces-logic"><span class="header-section-number">4.2</span> Darwin’s (and Wallace’s) Logic</a>
  <ul class="collapse">
  <li><a href="#variation" id="toc-variation" class="nav-link" data-scroll-target="#variation"><span class="header-section-number">4.2.1</span> Variation</a></li>
  <li><a href="#heritability" id="toc-heritability" class="nav-link" data-scroll-target="#heritability"><span class="header-section-number">4.2.2</span> Heritability</a></li>
  <li><a href="#the-struggle-for-existence" id="toc-the-struggle-for-existence" class="nav-link" data-scroll-target="#the-struggle-for-existence"><span class="header-section-number">4.2.3</span> The Struggle for Existence</a></li>
  <li><a href="#non-random-survival-and-reproduction" id="toc-non-random-survival-and-reproduction" class="nav-link" data-scroll-target="#non-random-survival-and-reproduction"><span class="header-section-number">4.2.4</span> Non-Random Survival and Reproduction</a></li>
  </ul></li>
  <li><a href="#putting-darwins-logic-to-the-test" id="toc-putting-darwins-logic-to-the-test" class="nav-link" data-scroll-target="#putting-darwins-logic-to-the-test"><span class="header-section-number">4.3</span> Putting Darwin’s Logic to the Test</a>
  <ul class="collapse">
  <li><a href="#is-there-variation-in-beak-size" id="toc-is-there-variation-in-beak-size" class="nav-link" data-scroll-target="#is-there-variation-in-beak-size"><span class="header-section-number">4.3.1</span> Is there Variation in Beak Size?</a></li>
  <li><a href="#is-variation-in-beak-size-heritable" id="toc-is-variation-in-beak-size-heritable" class="nav-link" data-scroll-target="#is-variation-in-beak-size-heritable"><span class="header-section-number">4.3.2</span> Is Variation in Beak Size Heritable?</a></li>
  <li><a href="#is-there-a-struggle-for-existence" id="toc-is-there-a-struggle-for-existence" class="nav-link" data-scroll-target="#is-there-a-struggle-for-existence"><span class="header-section-number">4.3.3</span> Is there a Struggle for Existence?</a></li>
  <li><a href="#is-survival-non-random" id="toc-is-survival-non-random" class="nav-link" data-scroll-target="#is-survival-non-random"><span class="header-section-number">4.3.4</span> Is Survival Non-Random?</a></li>
  <li><a href="#did-non-random-survival-lead-to-evolution" id="toc-did-non-random-survival-lead-to-evolution" class="nav-link" data-scroll-target="#did-non-random-survival-lead-to-evolution"><span class="header-section-number">4.3.5</span> Did Non-Random Survival Lead to Evolution?</a></li>
  </ul></li>
  <li><a href="#among-population-variation" id="toc-among-population-variation" class="nav-link" data-scroll-target="#among-population-variation"><span class="header-section-number">4.4</span> Among-Population Variation</a></li>
  <li><a href="#some-clarifications-on-natural-selection-or-the-nature-of-natural-selection" id="toc-some-clarifications-on-natural-selection-or-the-nature-of-natural-selection" class="nav-link" data-scroll-target="#some-clarifications-on-natural-selection-or-the-nature-of-natural-selection"><span class="header-section-number">4.5</span> Some clarifications on natural selection, or the Nature of Natural Selection</a></li>
  <li><a href="#studying-adaptations" id="toc-studying-adaptations" class="nav-link" data-scroll-target="#studying-adaptations"><span class="header-section-number">4.6</span> Studying Adaptations</a></li>
  <li><a href="#reflection-questions" id="toc-reflection-questions" class="nav-link" data-scroll-target="#reflection-questions"><span class="header-section-number">4.7</span> Reflection Questions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">4.8</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./IntroBasicConcepts.html">Introduction: Basic Concepts</a></li><li class="breadcrumb-item"><a href="./HowNaturalSelectionWorks.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">How Natural Selection Works</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-howselworks" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">How Natural Selection Works</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>DRAFT 20250113</em></p>
<section id="a-mechanism-for-change" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="a-mechanism-for-change"><span class="header-section-number">4.1</span> A Mechanism for Change</h2>
<p>Darwin’s core contribution to science was not just his assemblage of evidence for the pattern of evolution, but also the conception of a mechanism that could explain such patterns: natural selection. In doing so, he formalized an idea that humans have used for millennia to shape traits of agricultural crops, livestock, and companion animals. If you weed out the duds and promote the variants you desire, you end up with giant potatoes, hens that lay over 300 eggs a year, pigs that produce the most scrumptious bacon, and the most adorable puppies that steal your well-bred breakfast.</p>
<p>Humans have been domesticating plants and animals for various purposes for over 10,000 years, thereby shaping their evolution. The recipe for success was relatively simple: assess the traits of individuals in your stock, choose the ones with the desired traits for breeding, and keep doing just that, time and time again. While we—as humans—have a long history of selective breeding, it does not actually take that much time for artificial selection to have profound effects. The speed at which we can domesticate animals was illustrated by an experiment that aimed to better understand the evolution of dogs from wolves by selectively breeding foxes.</p>
<p>In 1959, Lyudmila Trut and Dmitri Belyaev started to selectively breed silver foxes (<em>Vulpes vulpes</em>) in a Russian fur farm (Dugatkin 2018). Breeders were selected based on their tameness. Foxes that were curious toward humans were retained, while those that were shy or even aggressive… well, they became coats for the Russian elite. Over a few decades, foxes in this experiment not only became tamer and tamer, but they also exhibited changes in a variety of other traits: their facial structure diverged, some exhibited floppy ears and curly tails, their coat colors changed, and some even started to make novel sounds (seriously… read about <a href="https://www.amazon.com/Pushinka-Barking-Fox-Unexpected-Friendship/dp/1943978468"><em>Pushinka the Barking Fox</em></a><strong>)</strong>. Today, the foxes of this experiment still contribute to fur production, but you can also buy domesticated foxes as pets, even here in the United States. Selection on an apparently simple trait (tamness) lead to complex changes in the fox population in just a few decades.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><b>Explore More</b></p>
<p>To learn about the famous fox experiment, check out <a href="https://www.amazon.com/How-Tame-Fox-Build-Dog/dp/022659971X"><em>How to Tame a Fox (and Build a Dog): Visionary Scientists and a Siberian Tale of Jump-Started Evolution</em></a> by Lee Dugatkin and Lyudmila Trut, or <span class="citation" data-cites="dugatkin2018">(<a href="#ref-dugatkin2018" role="doc-biblioref">Dugatkin 2018</a>)</span>The Silver Fox Domestication Experiment by the same first author.</p>
</div>
</div>
<p>Darwin, through his experience with pigeon breeding, was not only aware of the power of selective breeding and domestication, but he was also able to relate that process to the patterns of evolutionary change he observed in nature. This chapter will take you through Darwin’s logic of natural selection.</p>
</section>
<section id="darwins-and-wallaces-logic" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="darwins-and-wallaces-logic"><span class="header-section-number">4.2</span> Darwin’s (and Wallace’s) Logic</h2>
<p>Natural selection explains evolution based on first principles; deceivingly simple and equally powerful. Darwin made four key observations, also know as Darwin’s postulates:</p>
<ol type="1">
<li><p>Individuals in a population vary in their traits.</p></li>
<li><p>Some of that trait variation is inherited from parents to their offspring.</p></li>
<li><p>More offspring are produced in every generation than can possibly survive.</p></li>
<li><p>Successful survival and reproduction of those offspring is not random but dependent on the traits they inherited from their parents.</p></li>
</ol>
<p>If these four observations hold true, then the consequence is that the heritable traits that impact survival and reproduction will change from one generation to the next. Beneficial variants will become more common through time, ultimately causing adaptation to the prevailing environmental conditions.</p>
<p>While we intuitively know at least some of Darwin’s postulates to be true, we should treat them all as hypotheses. We cannot only test whether the predictions of each postulate hold up, but we can also empirically test whether evolutionary change is really the consequence of the four postulates. In the following sections, we will take a closer look at the four postulates and discuss an actual case study of natural selection in the wild, building on what you learned about Darwin’s finches in the last chapter.</p>
<section id="variation" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="variation"><span class="header-section-number">4.2.1</span> Variation</h3>
<p>Individuals in a population vary in their traits. We know this to be true in humans; if you just look around the classroom, inter-individual differences become evident in many traits. While nearly all humans have one head, two eyes and ears, and five digits on each limb, we vary in body size, the relative proportions of morphological traits, the color of our skin, hair, and eyes, aspects of our physiology, as well as behavioral traits that make up our personalities. If you have ever cared for pets or plants in a garden, you will have some intuition about trait variation in those species, too.</p>
<p>From a practical perspective, the question is not so much <em>whether</em> individuals in a population vary, but which variable traits are actually important from a functional perspective. In other words, what traits should we actually be paying attention to as evolutionary biologists? For example, some humans have hair on their phalanges and some don’t. Does that matter? Probably not… This is where careful natural history observations come into play. To ask meaningful questions about evolution in natural systems, we have to consider organisms as holistic entities consisting of interacting traits in the context of the abiotic and biotic factors comprising their environment. So before going out into natural populations and quantifying variation, we want to formulate concrete hypotheses about the role of specific traits in shaping organismal performance in terms of survival and reproduction.</p>
<p>Once relevant traits for study have been identified, quantifying actual trait variation is not too difficult. It is amazing what ground-breaking data sets were collected merely using a caliper. But depending on the nature of a trait, any other method might be used to quantify inter-individual differences, from the molecular composition of cells all the way up to behavioral responses. Variation of traits among individuals in a population is typically visualized using frequency histograms (like in Figure @ref(fig:beaksizevariation)), and most traits in natural populations exhibit a normal distribution, where most individuals have intermediate trait values, and extreme trait values are more rare. We will explore why this is in <a href="the-evolution-of-quantitative-traits.html">Chapter 8</a>.</p>
<p>Ultimately, any variation we can observe and quantify in a population represents the raw material of evolution. Selection can act on variable traits, potentially causing evolutionary change—if said trait is heritable. If there is no variation, there can be no selection and accordingly no evolution, no matter how heritable a trait is.</p>
</section>
<section id="heritability" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="heritability"><span class="header-section-number">4.2.2</span> Heritability</h3>
<p>Once variation in a potentially interesting trait is quantified, we have to test whether trait variation is heritable. Many—if not all—quantitative traits are not only shaped by genes inherited by the parents, but also by environmental factors. For example, a child’s potential to grow tall is dependent on whether their parents were tall (<em>i.e.</em>, variation in genes that mediate growth) as well as adequate access to resources during the critical times in development. Similarly, the expression of certain colors in insects, fish, and birds is dependent on access to nutritional precursors and the genetically determined physiological capacity to turn those precursors into pigments deposited in tissues. Genetic and environmental effects work together to shape the variation of traits that we observe. So how can we determine the relative contribution of each?</p>
<p>Heritability measures the degree to which variation in a trait <em>in a population</em> is due to genetic variation. Thus, it is not a metric we can establish for a particular individual or a particular family; rather, we need to quantify the correspondence of parent and offspring traits across multiple families in a population. We can then plot offspring trait values as a function of their parents’ trait values and calculate regression lines. The slope of those parent-offspring regressions is a measure of heritability (in particular, narrow-sense heritability, but we will learn more about this in <a href="the-evolution-of-quantitative-traits.html">Chapter 8</a>). If the slope of the parent-offspring regression is close to one, it means there is almost perfect correspondence between parent and offspring traits, and heritability is high (blue line in Figure @ref(fig:herit)). If the slope of the line is close to zero, there is no correspondence between parent and offspring traits; in this case, phenotypic variation is entirely shaped by environmental influences, and there is no heritability (green line in Figure @ref(fig:herit)). Any slopes between zero and one (like the orange line in Figure @ref(fig:herit)) indicate that genetic and environmental factors both contribute to shaping trait variation in a population.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/herit-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption>The slope of parent-offspring regressions reveal the degree of heritability. A slope of one indicates high heritability (blue line), while a slope of zero indicates no heritability (orange line). Intermediate slopes indicate that genetic and environmental effects both impact trait variation in a population.</figcaption>
</figure>
</div>
</div>
</div>
<p>Just like variation is required for there to be selection, heritability is required to translate selection into evolutionary change. If there is no heritability in a trait, it cannot evolve. Evolutionary change in a trait is consequently not only shaped by selection, but also by the degree to which the trait is heritable.</p>
</section>
<section id="the-struggle-for-existence" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="the-struggle-for-existence"><span class="header-section-number">4.2.3</span> The Struggle for Existence</h3>
<p>All organisms have the potential to produce more offspring than required to replace themselves. Hence, all populations have the potential for exponential growth. We see evidence for such exponential growth whenever we inoculate a Petri dish with bacteria, when invasive species are introduced into a new area, or when pathogens spread through a population of susceptible hosts. But eventually, exponential growth comes to an end when resources get more scarce and competition intensifies. Nutrients on the agar will dwindle, invasives gradually encroach on all available spaces, and hosts either die off or develop immunity. Resource limitation and competition ultimately stifle exponential growth, and thus, natural population growth is typically density-dependent, which can be described using logistic growth cruves. During logistic growth, a carrying capacity sets the threshold beyond which positive population growth becomes impossible, because the resources to sustain additional population growth are not available.</p>
<p>Darwin was not the first to recognize the relationship between population growth and resource availability. In fact, he was inspired by an earlier economist, Thomas Malthus, who voiced concerns in the late 1700s about the growth of agricultural food production lagging behind human population growth. Although the industrial and agricultural revolutions proved Malthus wrong (global food production largely kept pace with human population growth), he was right about one thing: the growth of any population can only continue if its resources grow as well. Hence, most natural populations remain relatively stable through time despite the potential for exponential population growth (Figure @ref(fig:elephants)), aside from comparatively minor fluctuations across seasons and years.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/elephants-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Even animals with slow reprodictive rates have the potential for exponential growth. Depicted is the population size of African elephants in Kruger National Park, South Africa, after they were protected from hunting.</figcaption>
</figure>
</div>
</div>
</div>
<p>So where do all the extra offspring go? They die! Most individuals born succumb to a lack of resources, predators, or diseases long before they reach sexual maturity, and only a small fraction of offspring born in any generation survive long enough to reproduce. The consequence of this overproduction is fierce competition in every generation. This competition is what Darwin referred to as the struggle for existence. Natural selection is often particularly intense in populations that are close to their carrying capacity and in populations that are contracting.</p>
</section>
<section id="non-random-survival-and-reproduction" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="non-random-survival-and-reproduction"><span class="header-section-number">4.2.4</span> Non-Random Survival and Reproduction</h3>
<p>Darwin’s final proposition was that winners and losers in the struggle for existence are not determined by chance. Instead, specific traits and trait combinations lead to a higher probability of survival and reproduction. In a landscape plagued by drought, it is the plant with the deepest roots that has the best chance of persisting. In an stream rich in predators, the fish with the fastest escape response is most likely to dodge imminent attacks. In a forest with limited food resources, the parrot with the most efficient foraging strategy can garner enough food resources to produce and feed a clutch of young. Depending on the challenge at hand, individuals with specific traits or trait combinations will have a slight advantage over others.</p>
<p>Importantly, natural selection is not random. That does not mean natural selection is guided by conscious intent, as sometimes is insinuated. Rather, natural selection just happens because some variants have a disproportionate likelihood to survive and reproduce. As a consequence of natural selection’s non-random nature, evolution by natural selection increases adaptation from one generation to the next.</p>
<p>A concept related to natural selection is fitness, which is used to describe the strength of natural selection on different variants. Fitness in biology is not a measure of an individual’s physical prowess or health, but rather the relative contribution of a particular phenotype to the gene pool of the next generation.</p>
<div id="nte-fitness" class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note&nbsp;4.1: Some definitions
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Natural selection</strong> -a difference on average between survival and fecundity of individuals with certain phenotypes compared with individuals of other phenotypes.</p>
<p><strong>Fitness</strong> - The relative ability of individuals to survive and reproduce in its environment. Fitness quantifies individual reproductive success and represents the average contribution to the gene pool of the next (and subsequent) generation(s) by individuals <em>of the specified phenotype</em> in a given environment either via differential survival or reproductive success.</p>
<p><strong>Adaptation</strong> - Character that increases the ability of an individual to survive or reproduce better compared with some alternative trait or form of the character; trait that increases fitness relative to individuals lacking that trait.</p>
<p><strong>Preadaptation (exaptation)</strong> - Pre-existing character whose function changes to serve a new adaptive purpose.</p>
<p><strong>Maladaptation</strong> - a trait or characteristic that decreases the overall fitness of an organism, population, or species, either in absolute terms or relative to an optimal state. It is usually used to describe a trait that has become more harmful than beneficial over time, either due to changing environments or trade-offs with other traits. It contrasts with adaptation, which enhances fitness.</p>
</div>
</div>
<p>Fitness is relative in the sense that it is typically expressed for one phenotype in relation to another. For example, the fitness of mouse with a dark fur coat is higher relative to the fitness of a mouse with a light fur coat, because the darker coat color increases crypsis against the dark leaf litter of the forest habitat. Fitness is also context-dependent, and the relative fitness of two phenotypes may change depending on the environmental conditions. For example, in a mouse population inhabiting beaches, the light colored phenotype may have higher fitness, because it is better camouflaged against the light sand.</p>
</section>
</section>
<section id="putting-darwins-logic-to-the-test" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="putting-darwins-logic-to-the-test"><span class="header-section-number">4.3</span> Putting Darwin’s Logic to the Test</h2>
<p>The core strength of Darwin’s postulates is that they can be treated as hypotheses, and we can use data from natural populations to test whether evolution by natural selection is happening. In this section, we will once again retrace the steps of Rosemary and Peter Grant. In <a href="evidence-for-evolution.html">Chapter 2</a>, you explored their data on beak size variation of the <em>Geospiza fortis</em> population on Daphne Major Island (Figure @ref(fig:timeseries)). During a massive drought associated with an El Niño in 1977, there was a substantial increase of beak size over a short period of time. But does this change represent an evolutionary change caused by natural selection? If so, we would predict (1) observable variation in beak size in the <em>G. fortis</em> population, (2) that some of the beak size variation is heritable, (3) that the finches on Daphne Major are in fact facing a struggle for existence, and (4) that survival in the finch population is not random but related to beak size. Last but not least, we would also predict differences in beak size across generations.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/timeseries-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Variation of relative beak size in <em>G. fortis</em> on Daphne Major Island from 1972-1995. Positive numbers indicate larger beaks and negative number represent smaller beaks.</figcaption>
</figure>
</div>
</div>
</div>
<section id="is-there-variation-in-beak-size" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="is-there-variation-in-beak-size"><span class="header-section-number">4.3.1</span> Is there Variation in Beak Size?</h3>
<p>To test whether there is variation in beak size within the <em>G. fortis</em> population, we can use a frequency histogram to plot raw beak size data collected by the Grants (Figure @ref(fig:beaksizevariation)). As with most quantitative traits, beak size variation follows a normal distribution, with most individuals exhibiting intermediate beak sizes around 9.5 mm. However, the spread in beak sizes is vast; the smallest beaks measured just 6 mm, and the largest ones almost 14 mm. That is more than a two-fold spread! Therefore, there is clear variation in beak size that natural selection could potentially act upon; <em>i.e.</em>, we found evidence for Darwin’s first postulate.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/beaksizevariation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Frequency histogram showing beak size variation in the <em>G. fortis</em> population before the drought in 1976. <a href="data/3_beak_size_variation.csv">Data</a> from Boag and Grant (1984).</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="is-variation-in-beak-size-heritable" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="is-variation-in-beak-size-heritable"><span class="header-section-number">4.3.2</span> Is Variation in Beak Size Heritable?</h3>
<p>To test whether beak size is heritable, the Grants tracked the development of individuals by banding them with unique markers and comparing beak sizes of parents and their adult offspring. Plotting the average beak size of each parental pair against the average beak size of their offspring reveals a clear positive relationship between the two variables, both for families studied in 1976 and 1978 (Figure @ref(fig:heritability)). Parents with large beaks tended to raise chicks with large beaks, and parents with small beaks had chicks with small beaks. The slope of the regression lines for both years is almost 0.9, indicating a high heritability. So, beak size is not only variable but also highly heritable, providing evidence for Darwin’s second postulate.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/heritability-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Scatter plot showing the relationship between the beak size of the parents (average between mother and father) and their offspring (average across multiple siblings) measured separately in 1976 and 1978. <a href="data/3_parent_offspring.csv">Data</a> from Boag (1983).</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="is-there-a-struggle-for-existence" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="is-there-a-struggle-for-existence"><span class="header-section-number">4.3.3</span> Is there a Struggle for Existence?</h3>
<p>As with any population that has a capacity for exponential growth and is trapped in a small area, the struggle for existence in Darwin’s finches seems obvious, but election can be particularly strong when conditions are harsh and populations are contracting. Throughout the 1977 drought, finch populations on Daphne Major crashed from about 1,500 birds in March 1976 to to less than 200 birds in late 1977 (Figure @ref(fig:popsize)). This represents a decline of over 85 % in less than two years. The Grants were able to show that this decline was primarily related to a limitation of food resources, as the lack of significant precipitation limited plant growth and seed production on the island. Consequently, the Grants witnessed struggle for existence first hand, finding support of Darwin’s third postulate.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/popsize-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Population size of <em>G. fortis</em> on Daphne Major between July 1975 and January 1979. <a href="data/3_population_size.csv">Data</a> from Boag and Grant (1981).</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="is-survival-non-random" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="is-survival-non-random"><span class="header-section-number">4.3.4</span> Is Survival Non-Random?</h3>
<p>To test whether survival of birds was non-random in relation to beak size, we can compare the beak size distribution in individuals before the drought in 1976 and the birds that were left after the drought in 1978. As you can see in Figure @ref(fig:survival), surviving birds on average had a larger beak size than individuals prior to the selection event. The Grants were also able to explain exactly why a larger beak size conferred a selective advantage. As the drought progressed, there was not only a decline in seed abundance, but the average seed also became larger and harder, because the smaller and softer seeds were eventually all eaten up by the finches. As seed quality changed, finches with larger beaks had a foraging advantage, because they were able to open larger and harder seeds more effectively. The disproportionate survival of individuals with larger beaks provides clear evidence for Darwin’s fourth postulate.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/survival-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Frequency histograms showing beak size variation in the finch population before the drought (top) and in the surviving individuals after the drought (bottom). The vertical red lines represent the mean beak size in each set. The beak size of the average survivor was slightly higher than the population average prior to the drought, indicating that natural selection happened. <a href="data/3_beak_size_variation.csv">Data</a> from Boag and Grant (1984).</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="did-non-random-survival-lead-to-evolution" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="did-non-random-survival-lead-to-evolution"><span class="header-section-number">4.3.5</span> Did Non-Random Survival Lead to Evolution?</h3>
<p>At this stage, we have shown heritable variation in beak size, strong selection caused by a massive drought, and non-random survival associated with beak size. However, we have not yet shown that evolution has occurred. We have only shown the action of natural selection. But testing the hypothesis of evolutionary change requires the documentation of changes across generations, not just differential survival within generations. To do so, we can can compare the beak size of offspring born before the drought (1976) to the beak size of offspring both after the drought (in 1978; these are the offspring of the survivors). As expected, based on the high heritability of beak size, we see that the average offspring in 1978 exhibited a larger beak than the average offspring in 1976 (Figure @ref(fig:evolutionarychange)).</p>
<p>Taken together, these data sets conclusively show that the drastic change in beak size from 1976 to 1978 (Figure @ref(fig:timeseries)) represents evolution by natural selection. The finch population adapted to a new reality, where the average food source was larger and harder. The Grants’ pioneering work linked an evolutionary pattern that they observed to a concrete mechanism that explained the pattern; they documented the interplay of pattern and process in a naturally evolving population.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="HowNaturalSelectionWorks_files/figure-html/evolutionarychange-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Frequency histograms showing beak size variation in the finch offspring born before the drought (top) and after the drought (bottom). The vertical red lines represent the mean beak size in each set. The beak size of the average offspring born after the selection event was higher than the offspring average prior, indicating that evolution happened. <a href="data/3_offspring_beaks.csv">Data</a> from Grant and Grant 2003.</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="among-population-variation" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="among-population-variation"><span class="header-section-number">4.4</span> Among-Population Variation</h2>
<p>By following the finch population through time, Rosemary and Peter Grant were able to show evolution by natural selection in action. However, following populations through time is not a trivial effort. An indirect way to investigate the effects of natural selection on trait evolution is to compare different populations of the same species that are exposed to different environmental conditions. Comparing trait distributions among populations can provide insights about the actions of selection, just like a time series.</p>
</section>
<section id="some-clarifications-on-natural-selection-or-the-nature-of-natural-selection" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="some-clarifications-on-natural-selection-or-the-nature-of-natural-selection"><span class="header-section-number">4.5</span> Some clarifications on natural selection, or the Nature of Natural Selection</h2>
<p>In its most simplest form, natural selection is a fundamental concept in evolutionary biology that describes the process by which organisms with advantageous traits are more likely to survive and reproduce, passing those traits on to future generations. This was Darwin’s revolutionary concept, a mechanism that could explain the origin of species. So simple and elegant a concept. Yet, as we discussed in the Chapter 5, it would take well over a half century until natural selection was generally accepted as one of the primary drivers of the diversication of life. Even today there remains a lot of misunderstandings on how natural actually works. In this section we will explore and hopefully dispell some of the more lingering misunderstandings concerning the nature of natural selection.</p>
<ul>
<li><p><strong>Natural selection acts on individuals, but its consequences are expressed at the population level</strong>. Specifically, selection operates on phenotypes, the observable characteristics of organisms. For any one character, if there is variation for a character in a population and that variation results in some individuals able to survive or reproduce better than others in the population with a different value for that character, then the frequency of the favored phenotype will increase in the population. Selection does not change the individual, but simply causes it to increase in frequency in the population. The consequence of selection acting on the individual level (differential survive or reproduction), the <em>impact</em> is on the population level (<em>i.e.</em> changing the frequency of the phenotypic values).</p></li>
<li><p><strong>Selection acts on phenotypes, results in changes in allele frequencies</strong>. In order for natural selection to be effective across generations, the phenotypic character must be heritable to some extent, <em>i.e.</em> there must be a genetic basis to the variation found in the character in the populations. If true, then any change in the frequency of a heritable phenotype in population will result in changes in allele frequencies at the genes underlying the phenotypic variation within a population over time.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The idea of changes in allele frequencies is very classical way of thinking about this. From a more genomic perspective, the variation does not have be at the gene/allele level (where we formally define a gene as <em>a region of the genome that is transcribed into a functional product</em>). As we learn more about genome anatomies and the genome-phenome connection, we are finding that a lot of phenotypic variation is not necessarily driven by variation at genes in the formal sense, <em>i.e.</em> nucleotide polymorphisms in a protein coding region. Any variation in the genome that influences the character value (phenotype) will increase in frequency, be that an allele (variant form of a gene), a SNP, at a regulatory region, intergenic (between genes), or even a Structural Variant (SV).</p>
<p>So, though we will be discussing various selection models and their impact on allele frequencies, keep the above in mind. We are very loosely defining <em>allele</em> to include most any genomic variation, and not just at the gene level.</p>
</div>
</div>
<ul>
<li><p><strong>Selection depends on the immediate environment of an organism.</strong> The environment plays a pivotal role in natural selection, as it provides the context in which selection occurs. Interestingly, organisms can also influence their environment, creating a dynamic interplay between the two. However, natural selection is not a forward-looking process. It is the outcome of differences in survival and reproduction among existing variants in a population at that given moment in time. Natural selection will not select variants because they might prove useful in the future. It is pure here and now, acting on pre-existing variants from yesterday to determine the winners today.</p></li>
<li><p><strong>Levels of Selection.</strong> While selection acts on individuals, the consequences of selection can result in higher order patterns to a limited extent (<em>e.g.</em> group selection). However, there is no strong evidence that <strong>group selection</strong> (as formally defined) occurs. Instead, natural section will always work to increase the population fitness by favoring individual organisms with the higher fitness. The consequences of this may look like group selection, but it is not: <strong>selection does not act for the good of the population or species</strong>. Seemingly altruistic traits or selfless behaviors, which appear to benefit a species or population, actually reflect an increase in a type of fitness referred to as <strong>inclusive fitness</strong>.</p></li>
<li><p><strong>Natural selection does not cause adaptive changes to arise.</strong> Instead, it causes adaptive traits to become more frequent in a population, <em>i.e.</em> acts on preexisting variation. Mutations, which are the ultimate source of genetic variation, occur randomly with respect to fitness or necessity. Most mutations are deleterious, some neutral, and every once in awhile advantageous. It is these advantageous mutations that increase in frequency in a population due to natural selection. There is no solid evidence for directed mutation, <em>i.e.</em> specific mutations that purposely occur to benefit an individual.</p></li>
<li><p><strong>Despite acting only on pre-existing traits, selection can produce new traits and adaptations.</strong> There are various ways new traits can arise. For example:</p>
<ul>
<li>Shifting distributions of traits</li>
<li>Gradual change over time</li>
<li>Alterations in developmental pathways</li>
</ul></li>
<li><p><strong>The combination of variation and natural selection can lead to the evolution of completely novel features.</strong> There is no need for large phenotypic changes (saltations) to occur via mutation to explain the origin of completely novel features, though this does not preclude that happening. By acting on pre-existing characters, completely novel characters can arise either slowly over evolutionary time or quite rapidly. There is plenty of evidence for natural selection acting on a pre-existing character, changing it serve a new novel purpose, what we refer to as an <strong>exaptation</strong>. There is plenty of evidence for exaptations at the molecular level, but we can also find morphological exaptations as well.</p></li>
<li><p><strong>Natural selection does not lead to perfection.</strong> Adaptations often appear cobbled together and highly inefficient (certainly not something any intelligent designer would come up with if they wanted to keep their job). Natural selection only works on pre-existing variation. Because of the nature of natural selection, a variant form of a character just has to work better (on average) than other versions of the character in a population. If it does, and the variation has a genetic basis, it will increase in frequency in the populations. It just needs to be better, not the best. It does not mean the end result has to be the fastest or strongest or meanest. It just has to work better than others.</p></li>
<li><p><strong>There are limitations and constraints on natural selection.</strong> It’s important to recognize that there are all manner of limitations on natural selection driven by the fundamental rules of physics and chemistry, and basic biological limitations. These constraints include:</p>
<ol type="1">
<li><strong>Time lags</strong>: Evolutionary changes may not keep pace with environmental changes.</li>
<li><strong>Constraints</strong>: - Mechanical constraints (physics &amp; chemistry), genetic or developmental links between traits/genes, or even just a lack of variation (this is a big one) all place boundaries on how natural selection can work</li>
<li><strong>Tradeoffs</strong>: Improving one trait may come at the cost of another.</li>
<li><strong>Historical contingency</strong>: Past evolutionary events can limit future possibilities simply because the necessary biochemical or developmental pathways are not available (lacking in ancestors).</li>
</ol></li>
<li><p><strong>Complexity and Progression.</strong> Despite these limitations, natural selection can lead to extraordinary complexity. However, it’s crucial to understand that while selection is nonrandom, it is not necessarily progressive; it does not always lead to greater organismal complexity. If it is beneficial for an individual to lose some characteristic compare to others in the population that retain it, then selection can act on to reduce organismal complexity just as well (consider parasites for example). This does not mean there are no patterns or trends in the evolutionary record. It simply means that there is no driving force toward some <em>a priori</em> outcome. Remember, selection is about the here-and-now, not some preferred outcome.</p></li>
<li><p><strong>There is no inherent drive towards <em>balancing nature</em> or achieving harmony or equilibrium.</strong></p></li>
<li><p><strong>Ethical Considerations.</strong> Natural selection is fundamentally an amoral process (neither moral nor immoral). It simply lacks any ethical qualities. It is often described as a selfish, dark, and aesthetically unappealing process. As such, there are no great moral lessons to be learned from natural selection or the adaptations it drives.</p></li>
</ul>
<p>It’s crucial to avoid the <strong>naturalistic fallacy</strong> (the supposition that what is natural is inherently good) when thinking about natural and how evolution by natural selection works. Natural selection provides no code of ethics, no moral compass, and no justification for behaviors. It merely describes what is, not what ought to be.</p>
</section>
<section id="studying-adaptations" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="studying-adaptations"><span class="header-section-number">4.6</span> Studying Adaptations</h2>
<p>Evolution is a natural science. That being the case, explaining how a particular character may be an adaptation requires that we follow the “rule” of natural science, which means developing hypotheses, testing hypotheses and predictions, collecting relevant data, and analyzing and interpreting those data. Simply claiming that a character is an adaptation because you have a story that sounds good is not sound science. Until you can demonstrate empirical data that supports your story, it will still only remain a story regardless of how compelling it sounds.</p>
<p>Recognizing and studying adaptations involves several approaches:</p>
<ol type="1">
<li><strong>Complexity</strong>: If a character is complex, it is more likely to be the result of natural selection.</li>
<li><strong>Design</strong>: Characters that appear intricately designed for a specific environment are likely products of natural selection.</li>
<li><strong>Experimental evidence</strong>: Direct tests of adaptive hypotheses.</li>
<li><strong>Comparative method</strong>: Used to account for common ancestry when comparing traits across species.</li>
</ol>
<p>The first two approaches really should be starting points for developing hypotheses and predictions that can be tested using the last two, <strong>experimental evidence</strong> (both in the field and/or laboratory) and using the <strong>comparative method</strong>. We will discuss the comparative method later in the OER after we learn a little more about how to interpret and construct evolutionary trees.</p>
<p>In conclusion, natural selection is a powerful yet constrained process that shapes the diversity of life on Earth. Understanding its mechanisms, limitations, and implications is crucial for a comprehensive grasp of evolutionary biology.</p>
<hr>
</section>
<section id="reflection-questions" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="reflection-questions"><span class="header-section-number">4.7</span> Reflection Questions</h2>
<ol type="1">
<li><p>In your own words, how do you define fitness? How would you measure fitness in a natural population? Provide a concrete example; <em>i.e.</em>, be specific with what organism you have in mind and describe the concrete steps you would take to quantify fitness.</p></li>
<li><p>Think about the relation between natural selection and evolution. Can you explain why the presence of natural selection does not necessarily lead to evolutionary change? Can you explain how evolution might happen in the absence of natural selection?</p></li>
<li><p>If you look at the time series of beak size data from the Grants (Figure @ref(fig:timeseries)), you can see that after a steep increase in beak size right after the drought, beak sizes slowly decline throughout the 1980s. In fact, beak sizes reach pre-drought levels by the late 1980s. What do you think happened after the drought? Why did beak sizes not continue to increase or remain stable at a larger size?</p></li>
<li><p>In The Origin of Species, Darwin said:</p>
<blockquote class="blockquote">
<p>“As natural selection works solely by and for the good of each being, all corporeal and mental endowments will tend to progress toward perfection.”</p>
<p>Darwin, 1859</p>
</blockquote>
<p>What do you think of this statement? Can you think of reasons why natural selection does not actually lead to perfection?</p></li>
</ol>
</section>
<section id="references" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="references"><span class="header-section-number">4.8</span> References</h2>
<ul>
<li>Boag, PT (1983). <a href="https://onlinelibrary.wiley.com/doi/10.1111/j.1558-5646.1983.tb05618.x">The heritability of external morphology in Darwin’s ground finches (<em>Geospiza</em>) on Isla Daphne Major, Galapagos</a>. <em>Evolution</em> 37, 877–894.</li>
<li>Boag, PT, PR Grant (1981). <a href="https://science.sciencemag.org/content/214/4516/82">Intense natural selection in a population of Darwin’s finches (Geospizinae) in the Galapagos</a>. <em>Science</em> 214, 82–85.</li>
<li>Boag, PT, PR Grant (1984). <a href="https://academic.oup.com/biolinnean/article-abstract/22/3/243/2666306">The classical case of character release: Darwin’s finches (<em>Geospiza</em>) on Isla Daphne Major, Galápagos</a>. <em>Biological Journal of the Linnean Society</em> 22 243–287.</li>
<li>Darwin, C. (1859). <em>On the origin of species based on natural selection, or the preservation of favoured races in the struggle of life</em>. John Murray.</li>
<li>Dugatkin, LA (2018). <a href="https://evolution-outreach.biomedcentral.com/articles/10.1186/s12052-018-0090-x">The silver fox domestication experiment</a>. <em>Evolution: Education and Outreach</em> 11, 1–5.</li>
<li>Grant, PR, BR Grant (2002). <a href="https://science.sciencemag.org/content/296/5568/707">Unpredictable evolution in a 30-year study of Darwin’s finches</a>. <em>Science</em> 296: 707-711.</li>
<li>Grant, RB, PR Grant (2003). <a href="https://academic.oup.com/bioscience/article/53/10/965/254944">What Darwin’s Finches can teach us about the evolutionary origin and regulation of biodiversity</a>. <em>Bioscience</em> 53, 965–975.</li>
<li>Parzefall, J (2001). <a href="https://link.springer.com/article/10.1023/A:1011899817764">A review of morphological and behavioural changes in the cave molly, <em>Poecilia mexicana</em>, from Tabasco, Mexico</a>. <em>Environmental Biology of Fishes</em> 62, 263–275.</li>
<li>Tobler, M, TJ Dewitt, I Schlupp, FJ García de León, R Herrmann, PGD Feulner, … M Plath (2008). <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1558-5646.2008.00466.x">Toxic hydrogen sulfide and dark caves: phenotypic and genetic divergence across two abiotic environmental gradients in <em>Poecilia mexicana</em></a>. <em>Evolution</em> 62, 2643–2659.</li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-dugatkin2018" class="csl-entry" role="listitem">
Dugatkin, Lee Alan. 2018. <span>“The Silver Fox Domestication Experiment.”</span> <em>Evolution: Education and Outreach</em> 11 (1). <a href="https://doi.org/10.1186/s12052-018-0090-x">https://doi.org/10.1186/s12052-018-0090-x</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./EvidenceForEvolution.html" class="pagination-link" aria-label="Evidence for Evolution">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Evidence for Evolution</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./EvolTreesAndPhylogenetics.html" class="pagination-link" aria-label="Evolutionary Trees and Phylogenetics">
        <span class="nav-page-text">Evolutionary Trees and Phylogenetics</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>